# Эконометрический анализ данных

Проект состоит из **трёх основных частей**, каждая из которых анализирует отдельный датасет с применением специфических методик.

---

## Часть 1: Анализ цен на компьютеры

### 1.1 Датасет "Computers"

**Источник:** Пакет `Ecdat` в R

**Характеристика данных:**
- **Размер выборки:** 6,259 наблюдений
- **Период:** 1993–1995 гг., США
- **Объект анализа:** Персональные компьютеры серии Intel 486

### Переменные модели

| Переменная | Описание | Тип влияния |
|-----------|---------|-----------|
| **price** | Цена компьютера (долл.) | Зависимая переменная |
| **speed** | Тактовая частота процессора (МГц) | Положительное |
| **hd** | Размер жесткого диска (МБ) | Положительное |
| **ram** | Объем оперативной памяти (МБ) | Положительное |
| **screen** | Диагональ монитора (дюймы) | Положительное |
| **cd** | Наличие CD-дисковода (yes/no) | Положительное |
| **multi** | Мультимедийный комплект (yes/no) | Положительное |
| **premium** | Премиум-бренды IBM/Compaq (yes/no) | Отрицательное* |
| **ads** | Количество рекламных объявлений | Нейтральное |
| **trend** | Временной тренд (месяцы) | Отрицательное |

*Бренды IBM и Compaq имели более дешевые аналоги, несмотря на репутацию

### Ключевое

#### Спецификация модели
1. **Исключение мультиколлинеарности:**
   - Переменная `hd` (VIF ≈ 4) исключена из модели
   - Переменная `ads` исключена как незначимая
   - Финальная модель: `price ~ speed + ram + screen + cd + multi + premium + trend`

2. **Трансформация зависимой переменной:**
   - Тест Бокса-Кокса показал λ ≈ 0
   - Применено логарифмирование: `log(price)`
   - Улучшено распределение остатков

3. **Диагностика остатков:**
   - Тест Рамсея показал пропуск квадратичных членов (p < 2.2×10⁻¹⁶)
   - Визуальный анализ (crPlots) не выявил явных нелинейностей
   - Данные распределены неравномерно, что затрудняет интерпретацию квадратов

#### Точки высокой напряженности
- Выявлено 315 наблюдений с высокими hat-values
- После удаления коэффициенты остались значимы на 1% уровне
- **Вывод:** модель устойчива к выбросам

### Итоговая модель

$$\log(\text{price}) = 6.86 + 0.004 \times \text{speed} + 0.03 \times \text{ram} + 0.06 \times \text{screen}$$
$$+ 0.07 \times \text{cd} + 0.03 \times \text{multi} - 0.22 \times \text{premium} - 0.02 \times \text{trend}$$

**Характеристики модели:**
- R² = 0.754
- Скорректированный R² = 0.753
- F-статистика = 2,730.22***
- Все коэффициенты значимы (p < 0.01)
- Использованы робастные стандартные ошибки (White)

### Интерпретация коэффициентов

| Переменная | Эффект |
|-----------|--------|
| speed (1 МГц) | Цена ↑ 0.4% |
| ram (1 МБ) | Цена ↑ 3.0% |
| screen (1 дюйм) | Цена ↑ 5.5% |
| cd (наличие) | Цена ↑ 6.9% |
| multi (наличие) | Цена ↑ 3.4% |
| premium (бренд) | Цена ↓ 22.4% |
| trend (1 месяц) | Цена ↓ 2.0% |

---

## 1.2 Датасет "DoctorVisits"

**Источник:** Пакет `AER` в R

**Характеристика данных:**
- **Размер выборки:** 5,190 наблюдений
- **Период:** 1977–1978 гг., Австралия
- **Объект анализа:** Заболеваемость и посещение врача

### Переменные модели

| Переменная | Описание | Тип влияния |
|-----------|---------|-----------|
| **visits** | Визиты к врачу (последние 2 недели) | Зависимая переменная |
| **gender** | Пол (женщина = 1) | Положительное |
| **age** | Возраст (в сотнях лет) | Положительное |
| **income** | Годовой доход (в тыс. долл.) | Отрицательное |
| **illness** | Количество заболеваний | Положительное |
| **reduced** | Дни пониженной активности | Положительное |
| **health** | Оценка общего здоровья (Goldberg) | Положительное |
| **private** | Частная страховка | Положительное |
| **freepoor** | Бесплатная страховка (низкий доход) | Отрицательное* |
| **freerepat** | Бесплатная страховка (статус) | Положительное |
| **nchronic** | Хронические заболевания (не ограничивающие) | Положительное |
| **lchronic** | Хронические заболевания (ограничивающие) | Положительное |

*Люди с такой страховкой игнорируют симптомы или живут в отдаленных районах

### Ключевое

#### Отбор переменных
1. **Анализ мультиколлинеарности:**
   - Все VIF < 4 (нет серьезных проблем)
   - Исключены: `freerepat`, `nchronic` (незначимые)
   - Исключены: `private` и `lchronic` (p > 0.1)

2. **Трансформация зависимой переменной:**
   - Первоначально не применялось преобразование
   - Остатки имеют тяжелые хвосты
   - Решено оставить оригинальную шкалу для интерпретируемости

3. **Нелинейная спецификация:**
   - Тест Рамсея: пропущены квадратичные члены
   - Добавлена переменная `I(reduced²)` (статистически значима)
   - Вершина параболы между 11–12 днями нетрудоспособности
   - **Интерпретация:** максимальный эффект нетрудоспособности на визиты врача достигается в этом диапазоне

#### Диагностика
- **Hatvalues:** 498 точек высокой напряженности
- **Устойчивость:** некоторые коэффициенты чувствительны к выбросам
- **Гетероскедастичность:** обнаружена (Breusch-Pagan, p < 0.001)

### Итоговая модель

$$\text{visits} = 0.022 + 0.237 \times \text{age} - 0.057 \times \text{income} + 0.051 \times \text{illness}$$
$$+ 0.229 \times \text{reduced} - 0.010 \times \text{reduced}^2 + 0.019 \times \text{health} - 0.119 \times \text{freepoor}$$

**Характеристики модели:**
- R² = 0.213
- Скорректированный R² = 0.212
- F-статистика = 175.35***
- Использованы робастные стандартные ошибки (White)

---

## Часть 2: Многоуровневые модели (Mixed Models)

### Датасет "Exam"

**Источник:** Пакет `mlmRev` в R

**Характеристика данных:**
- **Уровень 1:** Студенты (подвыборка)
- **Уровень 2:** Школы (16 из 32 школ)
- **Зависимая переменная:** Стандартизированные экзаменационные результаты

### Построенные модели

#### Модель 1: Случайные константы

$$\text{normexam}_{ij} = \beta_{0i} + \beta_1 \times \text{standLRT}_{ij} + \beta_2 \times \text{sex}_{ij} + \varepsilon_{ij}$$

где $\beta_{0i} \sim N(0, 0.095)$

**Результаты:**
- Константа: 0.06 (незначима, p = 0.296)
- Тест способностей (standLRT): 0.55*** (99% доверия)
- Пол [M]: -0.20*** (девочки получают лучше)
- ICC = 0.17 (17% вариации объясняется школами)
- Marginal R² = 0.31, Conditional R² = 0.43

#### Модель 2: Случайные наклоны (без корреляции)

Добавлены случайные наклоны для переменной `standLRT`:

$$\beta_{1i} = 0.55 + \theta_i, \quad \theta_i \sim N(0, 0.021)$$

**Результаты:**
- Структура остатков улучшена
- Значимость коэффициентов сохранена

#### Модель 3: Случайные наклоны с корреляцией

$$\beta_{0i} \sim N(0, 0.095), \quad \beta_{1i} = 0.55 + \theta_i, \quad \text{corr}(\beta_{0i}, \beta_{1i}) = 0.54$$

**Интерпретация:**
- **Корреляция 0.54 значима** (LRT test, p = 0.019)
- **Смысл:** В школах с выше среднего базовым уровнем учащиеся показывают более крутой прирост результатов с ростом способностей
- Это указывает на то, что «сильные» школы не только дают лучшие результаты, но и лучше развивают потенциал способных учеников

### Применяемые диагностики

Анализ остатков (QQ-plot)  
Проверка трендов в остатках  
Визуализация случайных эффектов (dotplots)  
Тесты сравнения моделей (ANOVA, LRT)  

---

### Основные статистические тесты

| Тест | Назначение | Применение |
|------|----------|-----------|
| VIF | Мультиколлинеарность | Части 1.1, 1.2 |
| Box-Cox | Трансформация переменных | Части 1.1, 1.2 |
| RESET (Ramsey) | Пропущенные переменные | Части 1.1, 1.2 |
| Breusch-Pagan | Гетероскедастичность | Части 1.1, 1.2 |
| White HC0 | Робастные ошибки | Части 1.1, 1.2 |
| Wald test | Совместная значимость | Части 1.1, 1.2 |
| Hat-values | Точки высокой напряженности | Части 1.1, 1.2 |
| Cook's distance | Влиятельные наблюдения | Части 1.1, 1.2 |
| LRT (Likelihood Ratio Test) | Сравнение вложенных моделей | Часть 2 |

---

## Основные методологические подходы

### 1. Спецификация модели
- Теоретическое обоснование выбора переменных
- Анализ мультиколлинеарности (VIF)
- Проверка на пропущенные переменные (Ramsey RESET test)

### 2. Трансформация переменных
- Тест Бокса-Кокса для оптимальной трансформации
- Логарифмирование для улучшения остатков
- Добавление полиномиальных членов при необходимости

### 3. Диагностика моделей
- QQ-plots для проверки нормальности остатков
- Анализ выбросов и точек высокой напряженности
- Проверка устойчивости коэффициентов
- Тесты на гетероскедастичность

### 4. Учет нарушений предпосылок
- Применение робастных стандартных ошибок (White HC0)
- Взвешенные наименьшие квадраты (при необходимости)
- Многоуровневое моделирование (для иерархических данных)

---

## Ключевые результаты

### Часть 1.1 — Компьютеры
- Объяснено 75.4% вариации цены
- Все коэффициенты статистически значимы
- Модель устойчива к выбросам

### Часть 1.2 — Визиты врача
- Найдена оптимальная нелинейная спецификация
- Объяснено 21.3% вариации
- Выявлена оптимальная нетрудоспособность (11–12 дней)

### Часть 2 — Образование
- Показано значимое влияние школы на результаты
- Выявлена положительная корреляция (0.54) между случайными эффектами
- Conditional R² = 0.427, улучшение на 11.7% за счет случайных эффектов
